/*!
 * vuex-arcsecond-module-generator v0.2.2
 * (c) 2018 CeÃÅdric Foellmi
 * Released under the MIT License.
 */

!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("vue"),require("lodash")):"function"==typeof define&&define.amd?define(["exports","vue","lodash"],n):n(e.VuexArcsecondModuleGenerator=e.VuexArcsecondModuleGenerator||{},e.Vue,e._)}(this,function(e,n,t){"use strict";n="default"in n?n.default:n,t="default"in t?t.default:t;var r="tree_parent_id",u=function(e){return e.charAt(0).toUpperCase()+e.substring(1)},i=function(e){return{SUCCESS:e+"_SUCCESS",FAILURE:e+"_FAILURE",PENDING:e+"_PENDING"}},c=function(e){return{list:i(e+"_LIST_FETCH"),create:i(e+"_SINGLE_CREATE"),read:i(e+"_SINGLE_READ"),update:i(e+"_SINGLE_UPDATE"),delete:i(e+"_SINGLE_DELETE")}},o=function(e){return{list:"list"+e+"s",create:"create"+e,read:"read"+e,update:"update"+e,delete:"delete"+e}},l=function(e,n,r){var u;return!1!==(u=r(e,n))&&t.each(e,function(e){return!1===u||t.isNil(e.children)||(u=l(e.children,n,r)),u}),u},a=function(e,r,u){return{list:function(n,t,r){n[e]=t},create:function(u,i){u.allowTree&&u[r]?n.set(u[r],"children",t.concat(u[r].children||[],i)):u[e]=t.concat(u[e],i)},read:function(n,i,c){if(n.allowTree&&n[r]);else{var o=t.findIndex(n[e],function(e){return e[u]===i[u]});-1!==o&&n[e].splice(o,1,i)}},update:function(i,c,o){if(i.allowTree)i[r]||n.set(i[r],"children",t.concat(i[r].children||[],c));else{var l=t.findIndex(i[e],function(e){return e[u]===c[u]});-1!==l&&i[e].splice(l,1,c)}},delete:function(n,r,i){n.allowTree?l(n[e],r[u],function(e,n){var r=t.findIndex(e,function(e){return e[u]===n});if(-1!==r)return e.splice(r,1),!1}):n[e]=n[e].filter(function(e){return e[u]!==r})}}},d=function(e,n,u){return{list:function(n){return e.get(n)},create:function(n){return t.isNil(n[r])?e.post(n):e.subresource(n[r].toString()+"/").post(n[u])},read:function(n){return e.get(n)},update:function(t){return e.put(t[n],t[u])},delete:function(n){return e.delete(n)}}};function f(e,n,r,i,l){var f=r.toLowerCase(),s=u(f),E=f+"s",p=f+"Crud",_="selected"+s,S=c(E.toUpperCase()),h="select"+s,I="changeSelected"+s+"Name",N=a(E,_,i),v=["list","create","read","update","delete"],A=o(s),C=d(n,i,"data"),T={},m={},L={};return T.allowTree=e,T[E]=[],T[p]=t.zipObject(v,[!1,!1,null,null,null]),T[_]=null,t.forEach(v.filter(function(e){return l.includes(e.charAt(0))}),function(e){var n,r=["list","create"];t.merge(m,((n={})[S[e].PENDING]=function(n,t){n[p][e]=!!r.includes(e)||t},n[S[e].SUCCESS]=function(n,t,u){N[e](n,t,u),n[p][e]=!r.includes(e)&&null},n[S[e].FAILURE]=function(n){n[p][e]=!r.includes(e)&&null},n))}),m[h]=function(e,n){e[_]=n},m["de"+h]=function(e){e[_]=null},m[I]=function(e,n){e[_].name=n},t.forEach(v,function(e){l.includes(e.charAt(0))&&(L[A[e]]=function(n,t){var r=n.commit;return new Promise(function(n,u){r(S[e].PENDING,t),C[e](t).then(function(u){var i=u.body||u.data;r(S[e].SUCCESS,i,t),n(i)},function(n){r(S[e].FAILURE),u(n)})})})}),{namespaced:!0,state:T,getters:{},mutations:m,actions:L}}e.TREE_PARENT_ID=r,e.createAsyncMutation=i,e.makeListModule=function(e,n,t,r){return void 0===r&&(r="lcrud"),f(!1,e,n,t,r)},e.makeTreeModule=function(e,n,t,r){return void 0===r&&(r="lcrud"),f(!0,e,n,t,r)},Object.defineProperty(e,"__esModule",{value:!0})});